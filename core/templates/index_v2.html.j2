<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monitoring Hub | The Exporter Registry</title>
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        slate: { 950: '#020617' }
                    }
                }
            }
        }
    </script>
    <style>
        [x-cloak] { display: none !important; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #020617; }
        ::-webkit-scrollbar-thumb { background: #1e293b; border-radius: 4px; }
        .glass { background: rgba(15, 23, 42, 0.6); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.05); }
        .card-glow:hover { box-shadow: 0 0 40px 5px rgba(99, 102, 241, 0.15); border-color: rgba(99, 102, 241, 0.4); }
        .kbd { background: #1e293b; border: 1px solid #334155; border-radius: 4px; padding: 2px 6px; font-size: 10px; font-weight: 800; color: #94a3b8; }
    </style>
</head>
<body class="bg-[#020617] text-slate-300 font-sans antialiased text-left" 
      x-data="registryApp()"
      x-init="init()"
      @keydown.window.prevent.ctrl.k="showSearch = true"
      @keydown.window.prevent.cmd.k="showSearch = true">

    <!-- Search Modal -->
    <div x-show="showSearch" 
         class="fixed inset-0 z-[200] flex items-start justify-center pt-24 sm:pt-40 px-4"
         x-cloak>
        <div class="absolute inset-0 bg-slate-950/90 backdrop-blur-sm" @click="showSearch = false" x-transition.opacity></div>
        <div class="relative w-full max-w-xl bg-slate-900 border border-white/10 rounded-2xl shadow-2xl overflow-hidden shadow-indigo-500/20"
             x-transition:enter="transition ease-out duration-200"
             x-transition:enter-start="scale-95 opacity-0"
             x-transition:enter-end="scale-100 opacity-100">
            <div class="p-6 border-b border-white/5 flex items-center gap-4 text-left">
                <i data-lucide="search" class="w-6 h-6 text-indigo-500"></i>
                <input type="text" 
                       x-model="search"
                       x-ref="searchInput"
                       @keydown.escape="showSearch = false"
                       placeholder="Find your exporter..."
                       class="flex-1 bg-transparent border-none text-white focus:outline-none text-xl font-medium">
                <span class="kbd uppercase">ESC</span>
            </div>
            <div class="max-h-[400px] overflow-y-auto p-4 space-y-2">
                <template x-for="exporter in filteredExporters" :key="exporter.name">
                    <div @click="selectedExporter = exporter; showSearch = false" 
                         class="flex items-center justify-between p-4 rounded-2xl hover:bg-white/5 cursor-pointer group transition-all text-left">
                        <div class="flex items-center gap-4">
                            <div class="w-10 h-10 bg-white/5 rounded-xl flex items-center justify-center text-slate-400 group-hover:bg-indigo-500/20 group-hover:text-indigo-400 transition-all">
                                <i :data-lucide="getIcon(exporter.category)" class="w-5 h-5"></i>
                            </div>
                            <div>
                                <div class="font-bold text-white group-hover:text-indigo-400 transition-colors" x-text="exporter.name"></div>
                                <div class="text-xs text-slate-500 line-clamp-1 text-left" x-text="exporter.description"></div>
                            </div>
                        </div>
                        <i data-lucide="arrow-right" class="w-4 h-4 text-slate-700 group-hover:text-indigo-400 group-hover:translate-x-1 transition-all"></i>
                    </div>
                </template>
            </div>
        </div>
    </div>

    <!--Navbar -->
    <nav class="sticky top-0 z-50 w-full border-b border-white/5 bg-[#020617]/80 backdrop-blur-xl">
        <div class="max-w-7xl mx-auto px-6 h-16 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center shadow-lg shadow-indigo-500/20 text-white">
                    <i data-lucide="boxes" class="w-4 h-4"></i>
                </div>
                <span class="text-lg font-black text-white tracking-tighter uppercase italic">Registry</span>
            </div>
            
            <div class="flex items-center gap-4">
                <button @click="showSearch = true" class="hidden sm:flex items-center gap-3 px-3 py-1.5 bg-white/5 hover:bg-white/10 border border-white/10 rounded-lg text-slate-400 transition-all">
                    <i data-lucide="search" class="w-4 h-4"></i>
                    <span class="text-xs font-medium">Search...</span>
                    <span class="kbd text-left">CTRL K</span>
                </button>
                <div class="h-4 w-[1px] bg-white/10 mx-2"></div>
                <a href="https://github.com/SckyzO/monitoring-hub" target="_blank" class="p-2 hover:bg-white/5 rounded-full text-slate-400 hover:text-white transition-all text-left">
                    <i data-lucide="github" class="w-5 h-5"></i>
                </a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <header class="relative pt-16 pb-12 px-6 text-center border-b border-white/5 bg-slate-900/10 overflow-hidden">
        <div class="absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-indigo-500/10 via-transparent to-transparent opacity-50"></div>
        <div class="max-w-4xl mx-auto relative z-10">
            <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-indigo-500/10 border border-indigo-500/20 text-indigo-400 text-[10px] font-bold uppercase tracking-widest mb-6">
                <span class="w-1.5 h-1.5 rounded-full bg-indigo-500 animate-pulse"></span>
                Software Factory Active
            </div>
            <h1 class="text-4xl md:text-5xl lg:text-6xl font-black text-white tracking-tightest mb-4 uppercase italic leading-tight">
                Monitoring Hub
            </h1>
            <p class="text-lg text-slate-400 font-light max-w-xl mx-auto mb-10 leading-relaxed italic">
                Production-ready Prometheus exporters. Secured & Multi-arch.
            </p>
            
            <!-- Main Search Input -->
            <div class="max-w-xl mx-auto relative group">
                <i data-lucide="search" class="absolute left-5 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-500 group-focus-within:text-indigo-400 transition-colors"></i>
                <input type="text" x-model="search" placeholder="Find exporter..."
                       class="w-full bg-slate-900 border border-white/10 rounded-2xl py-4 pl-14 pr-6 text-white focus:outline-none focus:ring-4 focus:ring-indigo-500/20 focus:border-indigo-500/50 transition-all text-xl font-medium shadow-3xl">
            </div>
        </div>
    </header>

    <!-- Content & Toolbar -->
    <main class="max-w-7xl mx-auto px-6 py-12">
        
        <div class="flex flex-wrap items-center justify-between gap-6 mb-10 border-b border-white/5 pb-6">
            <div class="flex items-center gap-8 overflow-x-auto scrollbar-hide">
                <!-- Categories -->
                <div class="flex items-center gap-2">
                    <button @click="category = 'all'" :class="category === 'all' ? 'bg-white text-black' : 'text-slate-500 hover:text-white bg-white/5'" class="px-4 py-1.5 rounded-lg text-[9px] font-black uppercase tracking-widest transition-all">All</button>
                    <template x-for="cat in categories" :key="cat">
                        <button @click="category = cat" 
                                :class="category === cat ? 'bg-indigo-600 text-white' : 'text-slate-500 hover:text-white bg-white/5'"
                                class="px-4 py-1.5 rounded-lg text-[9px] font-black uppercase tracking-widest transition-all" 
                                x-text="cat"></button>
                    </template>
                </div>

                <div class="h-4 w-[1px] bg-white/10 hidden md:block"></div>

                <!-- OS Filter -->
                <div class="flex items-center gap-2">
                    <span class="text-[8px] font-black text-slate-600 uppercase tracking-[0.2em] mr-1">OS</span>
                    <div class="flex bg-white/5 p-1 rounded-lg border border-white/5">
                        <button @click="os = 'all'" :class="os === 'all' ? 'bg-white/10 text-indigo-400' : 'text-slate-500 hover:text-white'" class="px-3 py-1 rounded-md text-[8px] font-black uppercase transition-all">Any</button>
                        <button @click="os = 'el8'" :class="os === 'el8' ? 'bg-white/10 text-indigo-400' : 'text-slate-500 hover:text-white'" class="px-3 py-1 rounded-md text-[8px] font-black uppercase transition-all">EL8</button>
                        <button @click="os = 'el9'" :class="os === 'el9' ? 'bg-white/10 text-indigo-400' : 'text-slate-500 hover:text-white'" class="px-3 py-1 rounded-md text-[8px] font-black uppercase transition-all">EL9</button>
                        <button @click="os = 'el10'" :class="os === 'el10' ? 'bg-white/10 text-indigo-400' : 'text-slate-500 hover:text-white'" class="px-3 py-1 rounded-md text-[8px] font-black uppercase transition-all">EL10</button>
                    </div>
                </div>
            </div>

            <div class="flex items-center bg-white/5 p-1 rounded-xl border border-white/5">
                <button @click="view = 'grid'" :class="view === 'grid' ? 'bg-white text-black' : 'text-slate-500 hover:text-white'" class="p-2 rounded-lg transition-all text-left">
                    <i data-lucide="grid" class="w-4 h-4"></i>
                </button>
                <button @click="view = 'list'" :class="view === 'list' ? 'bg-white text-black' : 'text-slate-500 hover:text-white'" class="p-2 rounded-lg transition-all text-left">
                    <i data-lucide="list" class="w-4 h-4"></i>
                </button>
            </div>
        </div>

        <!-- Grid View -->
        <div x-show="view === 'grid'" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 text-left">
            <template x-for="exporter in filteredExporters" :key="exporter.name">
                <div @click="selectedExporter = exporter" 
                     class="group relative flex flex-col bg-white/[0.02] border border-white/5 rounded-3xl p-8 hover:bg-white/[0.04] transition-all cursor-pointer card-glow overflow-hidden text-left">
                    
                    <div class="flex justify-between items-start mb-8 text-left">
                        <div class="w-12 h-12 bg-white/5 rounded-xl flex items-center justify-center text-slate-400 group-hover:bg-indigo-600 group-hover:text-white transition-all duration-300 text-left">
                            <i :data-lucide="getIcon(exporter.category)" class="w-6 h-6"></i>
                        </div>
                        <div class="flex flex-col items-end gap-2 text-left">
                            <template x-if="exporter.new">
                                <span class="px-2 py-0.5 bg-indigo-500 text-white text-[8px] font-black rounded-full uppercase tracking-widest animate-pulse">New</span>
                            </template>
                            <template x-if="exporter.updated && !exporter.new">
                                <span class="px-2 py-0.5 bg-amber-500 text-black text-[8px] font-black rounded-full uppercase tracking-widest">Updated</span>
                            </template>
                            <span class="px-3 py-1 bg-white/5 rounded-full text-[10px] font-black font-mono text-slate-500 group-hover:text-indigo-400 transition-colors uppercase" x-text="`v${exporter.version}`"></span>
                        </div>
                    </div>

                    <h3 class="text-xl font-black text-white mb-2 tracking-tight uppercase italic group-hover:translate-x-1 transition-transform text-left" x-text="exporter.name.replace('_', ' ')"></h3>
                    <p class="text-slate-400 text-sm leading-relaxed mb-8 line-clamp-2 h-10 font-medium text-left" x-text="exporter.description"></p>

                    <div class="mt-auto flex items-center justify-between border-t border-white/5 pt-6 text-left">
                        <div class="flex gap-1.5 text-left">
                            <template x-for="arch in (exporter.build?.archs || ['amd64', 'arm64'])">
                                <span class="text-[8px] font-black text-slate-400 bg-slate-800 px-1.5 py-0.5 rounded text-left" x-text="arch.toUpperCase()"></span>
                            </template>
                        </div>
                        <i data-lucide="arrow-up-right" class="w-4 h-4 text-slate-700 group-hover:text-indigo-500 transition-colors"></i>
                    </div>
                </div>
            </template>
        </div>

        <!-- List View (v2.4 Compact & Single-Line) -->
        <div x-show="view === 'list'" class="space-y-1" x-cloak>
            <template x-for="exporter in filteredExporters" :key="exporter.name">
                <div @click="selectedExporter = exporter" 
                     class="flex items-center gap-4 px-4 py-2 bg-white/[0.01] hover:bg-white/[0.04] border border-white/5 rounded-xl transition-all cursor-pointer group">
                    <div class="w-8 h-8 flex-shrink-0 bg-white/5 rounded-lg flex items-center justify-center text-slate-500 group-hover:text-indigo-400 transition-all">
                        <i :data-lucide="getIcon(exporter.category)" class="w-4 h-4"></i>
                    </div>
                    
                    <div class="flex-1 flex items-center gap-4 min-w-0">
                        <h4 class="text-sm font-black text-white uppercase italic tracking-tighter truncate w-48 flex-shrink-0" x-text="exporter.name"></h4>
                        <div class="h-3 w-[1px] bg-white/10 flex-shrink-0"></div>
                        <p class="text-[11px] text-slate-500 truncate font-medium" x-text="exporter.description"></p>
                    </div>

                    <div class="flex items-center gap-3 flex-shrink-0">
                        <div class="flex gap-1">
                            <template x-for="arch in (exporter.build?.archs || ['amd64', 'arm64'])">
                                <span class="text-[7px] font-black text-slate-500 bg-white/5 px-1 py-0.5 rounded uppercase" x-text="arch"></span>
                            </template>
                        </div>
                        <template x-if="exporter.new">
                            <span class="px-1.5 py-0.5 bg-indigo-500 text-white text-[7px] font-black rounded-full uppercase tracking-tighter animate-pulse">New</span>
                        </template>
                        <template x-if="exporter.updated && !exporter.new">
                            <span class="px-1.5 py-0.5 bg-amber-500 text-black text-[7px] font-black rounded-full uppercase tracking-tighter">Updated</span>
                        </template>
                        <span class="text-[10px] font-mono font-bold text-indigo-500 w-16 text-right" x-text="`v${exporter.version}`"></span>
                        <i data-lucide="chevron-right" class="w-4 h-4 text-slate-800 group-hover:text-indigo-500 group-hover:translate-x-0.5 transition-all"></i>
                    </div>
                </div>
            </template>
        </div>
    </main>

    <!-- Side Drawer Details -->
    <div x-show="selectedExporter" class="fixed inset-0 z-[100] flex justify-end" x-cloak>
        <div x-show="selectedExporter" x-transition.opacity @click="selectedExporter = null" class="absolute inset-0 bg-slate-950/80 backdrop-blur-sm"></div>
        <div x-show="selectedExporter" 
             x-transition:enter="transition transform duration-300" 
             x-transition:enter-start="translate-x-full" 
             class="relative w-full max-w-2xl bg-slate-900/90 backdrop-blur-2xl border-l border-white/10 h-full flex flex-col shadow-2xl overflow-hidden">
            
            <!-- Drawer Header -->
            <div class="p-8 border-b border-white/5 flex items-center justify-between bg-white/[0.02]">
                <div class="flex items-center gap-5">
                    <button @click="selectedExporter = null" class="p-2 hover:bg-white/5 rounded-full text-slate-500 hover:text-white transition-all">
                        <i data-lucide="arrow-right" class="w-6 h-6"></i>
                    </button>
                    <div class="flex flex-col gap-1">
                        <div class="flex items-center gap-3">
                            <h2 class="text-3xl font-black text-white uppercase italic tracking-tighter" x-text="selectedExporter?.name"></h2>
                            <template x-if="selectedExporter?.new">
                                <span class="px-2 py-0.5 bg-indigo-500 text-white text-[9px] font-black rounded-full uppercase tracking-widest animate-pulse">New</span>
                            </template>
                        </div>
                        <span class="text-[10px] font-mono font-bold text-indigo-400 uppercase tracking-widest" x-text="`v${selectedExporter?.version}`"></span>
                    </div>
                </div>
            </div>

            <div class="flex-1 overflow-y-auto p-10 space-y-12 scrollbar-hide">
                
                <!-- Documentation Section (rendered from README) -->
                <section class="prose prose-invert prose-sm max-w-none">
                     <!-- Fallback to description if readme is empty or just title -->
                    <div x-html="marked.parse(selectedExporter?.readme || selectedExporter?.description || '')"></div>
                </section>

                <section x-data="{ localTab: 'docker' }">

                    <h4 class="text-[10px] font-black text-slate-500 uppercase tracking-[0.3em] mb-6 text-left italic">02 / Deployment</h4>
                    <div class="flex p-1 bg-white/5 rounded-xl w-fit border border-white/5 mb-6 text-left">
                        <button @click="localTab = 'docker'" :class="localTab === 'docker' ? 'bg-white text-black shadow-lg' : 'text-slate-500 hover:text-white'" class="px-8 py-2 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all">DOCKER</button>
                        <button @click="localTab = 'rpm'" :class="localTab === 'rpm' ? 'bg-white text-black shadow-lg' : 'text-slate-500 hover:text-white'" class="px-8 py-2 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all">RPM</button>
                    </div>

                    <div class="bg-black rounded-2xl border border-white/10 overflow-hidden shadow-2xl text-left">
                        <div class="flex items-center justify-between px-6 py-3 bg-white/5 border-b border-white/5 text-left">
                            <span class="text-[10px] font-black text-slate-500 uppercase tracking-widest" x-text="localTab === 'docker' ? 'Container Command' : 'DNF Package'"></span>
                            <div x-data="{ copied: false }">
                                <button @click="window.copyToClipboard(localTab === 'docker' ? `docker run -d -p 9999:${selectedExporter?.artifacts?.docker?.validation?.port || 9100} ghcr.io/sckyzo/monitoring-hub/${selectedExporter?.name}:latest` : `sudo dnf install -y ${selectedExporter?.name}`); copied = true; setTimeout(() => copied = false, 2000)" 
                                        class="text-[10px] font-black tracking-widest transition-all px-3 py-1 rounded bg-indigo-600 text-white hover:bg-indigo-500"
                                        :class="copied ? 'bg-emerald-500 text-black' : ''">
                                    <span x-text="copied ? 'DONE!' : 'COPY'"></span>
                                </button>
                            </div>
                        </div>
                        <div class="p-6 text-left">
                            <pre class="font-mono text-sm overflow-x-auto text-left"><code x-show="localTab === 'docker'" class="text-indigo-300" x-text="`docker run -d \ 
  -p ${selectedExporter?.artifacts?.docker?.validation?.port || 9100}:${selectedExporter?.artifacts?.docker?.validation?.port || 9100} \ 
  ghcr.io/sckyzo/monitoring-hub/${selectedExporter?.name}:latest`"></code><code x-show="localTab === 'rpm'" class="text-emerald-400" x-text="`# 1. Setup repository
sudo dnf install -y ${selectedExporter?.name}
sudo systemctl enable --now ${selectedExporter?.name}`"></code></pre>
                        </div>
                    </div>
                </section>

                <div class="grid grid-cols-2 gap-8 text-left">
                    <div class="text-left">
                        <h4 class="text-[9px] font-black text-slate-600 uppercase tracking-widest mb-4 text-left">Platforms</h4>
                        <div class="flex gap-2 flex-wrap text-left">
                            <template x-for="arch in (selectedExporter?.build?.archs || ['amd64', 'arm64'])">
                                <span class="px-3 py-1 bg-white/5 border border-white/10 rounded-lg text-[10px] font-black text-white uppercase text-left" x-text="arch"></span>
                            </template>
                        </div>
                    </div>
                    <div class="text-left">
                        <h4 class="text-[9px] font-black text-slate-600 uppercase tracking-widest mb-4 text-left">Distributions</h4>
                        <div class="flex gap-2 flex-wrap text-left">
                            <template x-for="dist in (selectedExporter?.artifacts?.rpm?.targets || [])">
                                <span class="px-3 py-1 bg-white/5 border border-white/10 rounded-lg text-[10px] font-black text-white uppercase text-left" x-text="dist"></span>
                            </template>
                        </div>
                    </div>
                </div>
            </div>

            <div class="p-8 border-t border-white/5 bg-white/[0.02] text-left">
                <a :href="`https://github.com/${selectedExporter?.upstream?.repo}`" target="_blank"
                   class="w-full flex items-center justify-center gap-3 py-4 bg-white text-black rounded-2xl font-black uppercase text-xs tracking-widest hover:bg-slate-200 transition-all text-left">
                    <i data-lucide="external-link" class="w-4 h-4"></i> Official Source
                </a>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="py-16 px-6 border-t border-white/5 bg-[#020617] text-left">
        <div class="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center opacity-50 text-left">
            <div class="text-left">
                <p class="text-sm font-black text-white uppercase italic tracking-tighter mb-1 text-left">Monitoring Hub</p>
                <p class="text-slate-600 text-[10px] font-medium uppercase tracking-widest text-left">Registry Factory &copy; 2026</p>
            </div>
            <div class="flex gap-8 mt-8 md:mt-0 font-black text-[10px] tracking-widest uppercase text-slate-500 text-left">
                <a href="#" class="hover:text-white transition-colors text-left">Documentation</a>
                <a href="#" class="hover:text-white transition-colors text-left">GitHub</a>
            </div>
        </div>
    </footer>

    <!-- Data Injection -->
    <script id="exporters-data" type="application/json">{{ exporters_json | safe }}</script>
    <script id="categories-data" type="application/json">{{ categories_json | safe }}</script>

    <script>
        window.copyToClipboard = function(text) {
            navigator.clipboard.writeText(text);
        };

        function registryApp() {
            return {
                search: '',
                showSearch: false,
                selectedExporter: null,
                view: 'grid',
                category: 'all',
                os: 'all',
                exporters: [],
                categories: [],
                init() {
                    const data = document.getElementById('exporters-data');
                    if (data) this.exporters = JSON.parse(data.textContent);
                    const cats = document.getElementById('categories-data');
                    if (cats) this.categories = JSON.parse(cats.textContent);
                    
                    this.$watch('filteredExporters', () => this.$nextTick(() => lucide.createIcons()));
                    this.$watch('selectedExporter', () => this.$nextTick(() => lucide.createIcons()));
                    this.$watch('showSearch', (val) => {
                        if (val) this.$nextTick(() => this.$refs.searchInput.focus());
                    });
                    lucide.createIcons();
                },
                getIcon(category) {
                    const icons = {
                        'Database': 'database',
                        'Web': 'globe',
                        'Network': 'network',
                        'HPC': 'cpu',
                        'System': 'server',
                        'Infrastructure': 'layers',
                        'Storage': 'hard-drive',
                        'Hardware': 'microchip',
                        'Containers': 'box'
                    };
                    return icons[category] || 'package';
                },
                get filteredExporters() {
                    let items = this.exporters;
                    if (this.category !== 'all') {
                        items = items.filter(e => (e.category || 'System') === this.category);
                    }
                    if (this.os !== 'all') {
                        items = items.filter(e => {
                            const targets = e.artifacts?.rpm?.targets || [];
                            return targets.includes(this.os);
                        });
                    }
                    if (this.search) {
                        const s = this.search.toLowerCase();
                        items = items.filter(e => e.name.toLowerCase().includes(s) || (e.description && e.description.toLowerCase().includes(s)));
                    }
                    return items;
                }
            }
        }
    </script>
</body>
</html>