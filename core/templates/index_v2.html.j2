<!DOCTYPE html>
<html lang="en" x-data="registry()" x-init="init()" :class="theme === 'light' ? '' : 'dark'">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monitoring Hub | Registry</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'], mono: ['JetBrains Mono', 'monospace'] },
                    colors: {
                        primary: {
                            50: 'rgb(var(--primary-rgb) / <alpha-value>)',
                            500: 'rgb(var(--primary-rgb) / <alpha-value>)',
                            600: 'rgb(var(--primary-rgb) / 0.8)',
                        },
                        dark: { 950: '#000000', 900: '#09090b', 800: '#18181b', 700: '#27272a' }
                    }
                }
            }
        }
    </script>

    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <style>
        [x-cloak] { display: none !important; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .card-glow { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); border: 1px solid transparent; }
        .card-glow:hover {
            transform: translateY(-4px);
            box-shadow: 0 0 40px 5px rgba(var(--primary-rgb), 0.15);
            border-color: rgba(var(--primary-rgb), 0.4) !important;
        }
        .kbd { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 4px; padding: 2px 6px; font-size: 10px; font-weight: 800; color: #71717a; }
        .verified-badge { background: #e8f5e9; color: #2e7d32; padding: 2px 8px; border-radius: 6px; font-size: 0.7rem; font-weight: 800; display: inline-flex; align-items: center; gap: 4px; border: 1px solid #c8e6c9; }
        .dark .verified-badge { background: #064e3b; color: #6ee7b7; border-color: #065f46; }
        :root { --primary-rgb: 59, 130, 246; }
    </style>
</head>
<body class="font-sans antialiased min-h-screen flex flex-col transition-colors duration-500 text-left"
      :class="{ 'bg-zinc-100 text-zinc-900': theme === 'light', 'bg-dark-800 text-zinc-400': theme === 'deep', 'bg-dark-950 text-zinc-400': theme === 'oled' }"
      @keydown.window.prevent.ctrl.k="showCommandPalette = true"
      @keydown.window.prevent.cmd.k="showCommandPalette = true">

    <!-- Command Palette -->
    <div x-show="showCommandPalette" class="fixed inset-0 z-[200] flex items-start justify-center pt-24 sm:pt-40 px-4" x-cloak>
        <div class="absolute inset-0 bg-black/60 backdrop-blur-md" @click="showCommandPalette = false" x-transition.opacity></div>
        <div class="relative w-full max-w-2xl bg-zinc-900 border border-white/10 rounded-2xl shadow-2xl overflow-hidden backdrop-blur-2xl" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="scale-95 translate-y-4 opacity-0" x-transition:enter-end="scale-100 translate-y-0 opacity-100">
            <div class="p-6 border-b border-white/5 flex items-center gap-4 text-left">
                <i data-lucide="search" class="w-6 h-6 text-primary-500"></i>
                <input type="text" x-model="search" x-ref="commandInput" @keydown.escape="showCommandPalette = false" placeholder="Find exporters..." class="flex-1 bg-transparent border-none text-white focus:outline-none text-xl font-medium">
                <span class="kbd uppercase">ESC</span>
            </div>
            <div class="max-h-[400px] overflow-y-auto p-4 scrollbar-hide">
                <template x-for="item in filteredItems" :key="item.name">
                    <div @click="openDrawer(item); showCommandPalette = false" class="flex items-center justify-between p-4 rounded-xl hover:bg-white/5 cursor-pointer group transition-all text-left">
                        <div class="flex items-center gap-4">
                            <div class="w-10 h-10 bg-zinc-800 rounded-lg flex items-center justify-center text-zinc-500 group-hover:text-primary-400">
                                <i :data-lucide="getIcon(item.category)" class="w-5 h-5"></i>
                            </div>
                            <div class="text-left">
                                <div class="font-bold text-white group-hover:text-primary-400" x-text="item.name"></div>
                                <div class="text-xs text-zinc-500 line-clamp-1" x-text="item.description"></div>
                            </div>
                        </div>
                        <i data-lucide="arrow-right" class="w-4 h-4 text-zinc-700 group-hover:text-primary-400 group-hover:translate-x-1 transition-all"></i>
                    </div>
                </template>
            </div>
        </div>
    </div>

    <!-- Navbar -->
    <nav class="sticky top-0 z-40 w-full border-b backdrop-blur-xl transition-all"
         :class="{ 'bg-white/80 border-zinc-200 shadow-sm': theme === 'light', 'bg-dark-800/80 border-white/5': theme === 'deep', 'bg-dark-950/80 border-white/5': theme === 'oled' }">
        <div class="max-w-7xl mx-auto px-6 h-16 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-8 h-8 rounded-lg flex items-center justify-center text-white shadow-lg bg-primary-500 transition-all duration-500" :style="`box-shadow: 0 4px 12px rgba(var(--primary-rgb), 0.3)`">
                    <i data-lucide="activity" class="w-5 h-5"></i>
                </div>
                <span class="text-lg font-bold tracking-tight" :class="theme === 'light' ? 'text-zinc-900' : 'text-white'">Monitoring Hub</span>
            </div>
            <div class="flex items-center gap-4">
                <button @click="showCommandPalette = true" class="hidden sm:flex items-center gap-3 px-3 py-1.5 border rounded-lg transition-all w-64" :class="theme === 'light' ? 'bg-zinc-100 border-zinc-200 text-zinc-500 hover:bg-zinc-200' : 'bg-zinc-800 border-white/5 text-zinc-500 hover:text-zinc-300'"><i data-lucide="search" class="w-4 h-4"></i><span class="text-xs flex-1 text-left">Quick Search...</span><span class="kbd">CTRL K</span></button>
                <div class="flex items-center gap-2 border-l pl-4" :class="theme === 'light' ? 'border-zinc-200' : 'border-white/10'">
                    <div class="relative" x-data="{ open: false }">
                        <button @click="open = !open" @click.away="open = false" class="p-2 rounded-lg transition-colors" :class="theme === 'light' ? 'hover:bg-zinc-100 text-zinc-600' : 'hover:bg-white/5 text-zinc-400'"><i data-lucide="palette" class="w-5 h-5"></i></button>
                        <div x-show="open" class="absolute right-0 mt-3 w-72 rounded-2xl shadow-2xl border p-5 z-50 space-y-6 backdrop-blur-2xl bg-white dark:bg-zinc-900 border-zinc-200 dark:border-white/10">
                            <div class="space-y-3 text-left">
                                <p class="text-[10px] font-black uppercase tracking-widest text-zinc-500">Appearance</p>
                                <div class="grid grid-cols-3 gap-2">
                                    <button @click="theme = 'light'; localStorage.setItem('appearance', 'light')" :class="theme === 'light' ? 'border-primary-500 ring-2 ring-primary-500/20' : 'border-transparent bg-zinc-100'" class="flex flex-col items-center gap-2 p-2 rounded-xl border-2 transition-all text-zinc-500"><i data-lucide="sun" class="w-4 h-4 text-zinc-600"></i><span class="text-[9px] font-bold uppercase">Light</span></button>
                                    <button @click="theme = 'deep'; localStorage.setItem('appearance', 'deep')" :class="theme === 'deep' ? 'border-primary-500 ring-2 ring-primary-500/20' : 'border-transparent bg-zinc-800'" class="flex flex-col items-center gap-2 p-2 rounded-xl border-2 transition-all text-zinc-500"><i data-lucide="moon" class="w-4 h-4 text-zinc-400"></i><span class="text-[9px] font-bold uppercase text-zinc-400">Deep</span></button>
                                    <button @click="theme = 'oled'; localStorage.setItem('appearance', 'oled')" :class="theme === 'oled' ? 'border-primary-500 ring-2 ring-primary-500/20' : 'border-transparent bg-black'" class="flex flex-col items-center gap-2 p-2 rounded-xl border-2 transition-all text-zinc-500"><i data-lucide="zap" class="w-4 h-4 text-zinc-200"></i><span class="text-[9px] font-bold uppercase text-zinc-200">OLED</span></button>
                                </div>
                            </div>
                            <div class="space-y-3 text-left">
                                <p class="text-[10px] font-black uppercase tracking-widest text-zinc-500">Accent Color</p>
                                <div class="grid grid-cols-5 gap-2">
                                    <template x-for="c in colors" :key="c.name">
                                        <button @click="setThemeColor(c)" class="w-8 h-8 rounded-full border-2 transition-all" :style="`background-color: rgb(${c.value})`" :class="currentColor === c.name ? 'border-white scale-110 shadow-lg' : 'border-transparent opacity-70'"></button>
                                    </template>
                                </div>
                            </div>
                        </div>
                    </div>
                    <a href="https://github.com/SckyzO/monitoring-hub" target="_blank" class="p-2 rounded-lg transition-colors" :class="theme === 'light' ? 'hover:bg-zinc-100 text-zinc-600' : 'hover:bg-white/5 text-zinc-400'"><i data-lucide="github" class="w-5 h-5"></i></a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Content -->
    <main class="flex-1 max-w-7xl mx-auto px-6 py-12 w-full text-left">
        <div class="mb-12">
            <h1 class="text-4xl font-black mb-4 tracking-tighter uppercase italic" :class="theme === 'light' ? 'text-zinc-900' : 'text-white'">The Registry</h1>
            <p class="text-lg max-w-2xl font-medium italic" :class="theme === 'light' ? 'text-zinc-600' : 'text-zinc-500'">Enterprise collection of Prometheus exporters.</p>
        </div>

        <!-- Toolbar -->
        <div class="flex flex-wrap items-center justify-between gap-4 mb-10 text-left">
            <div class="flex gap-2 overflow-x-auto pb-2 sm:pb-0 scrollbar-hide text-left">
                <button @click="changeCategory('all')" class="px-4 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-widest border transition-all" :class="filterCategory === 'all' ? 'bg-primary-600 text-white border-transparent' : (theme === 'light' ? 'bg-white text-zinc-600 border-zinc-200' : 'bg-zinc-900 text-zinc-400 border-white/5')">All</button>
                <template x-for="cat in categories" :key="cat"><button @click="changeCategory(cat)" class="px-4 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-widest border transition-all" :class="filterCategory === cat ? 'bg-primary-600 text-white border-transparent' : (theme === 'light' ? 'bg-white text-zinc-600 border-zinc-200' : 'bg-zinc-900 text-zinc-400 border-white/5')" x-text="cat"></button></template>
            </div>
            <div class="flex items-center gap-2 p-1 rounded-lg border transition-colors" :class="theme === 'light' ? 'bg-white border-zinc-200' : 'bg-zinc-900 border-white/5'"><button @click="view = 'grid'" class="p-1.5 rounded-md transition-all" :class="view === 'grid' ? (theme === 'light' ? 'bg-zinc-100 text-zinc-900' : 'bg-zinc-800 text-white') : 'text-zinc-500'"><i data-lucide="grid" class="w-4 h-4"></i></button><button @click="view = 'list'" class="p-1.5 rounded-md transition-all" :class="view === 'list' ? (theme === 'light' ? 'bg-zinc-100 text-zinc-900' : 'bg-zinc-800 text-white') : 'text-zinc-500'"><i data-lucide="list" class="w-4 h-4"></i></button></div>
        </div>

        <!-- Grid -->
        <div x-show="view === 'grid'" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 text-left">
            <template x-for="item in filteredItems" :key="item.name">
                <div @click="openDrawer(item)" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0 scale-95" x-transition:enter-end="opacity-100 scale-100"
                     class="rounded-3xl p-8 cursor-pointer flex flex-col h-full card-glow transition-all text-left"
                     :class="{ 'bg-white border-zinc-200 shadow-sm': theme === 'light', 'bg-dark-700 border-white/5': theme === 'deep', 'bg-dark-900 border-white/5': theme === 'oled' }">
                    <div class="flex justify-between items-start mb-8 text-left">
                        <div class="w-12 h-12 rounded-2xl flex items-center justify-center transition-all duration-500 bg-primary-500/10 text-primary-500"><i :data-lucide="getIcon(item.category)" class="w-6 h-6"></i></div>
                        <div class="flex flex-col items-end gap-2 text-right">
                            <template x-if="item.new"><span class="px-2 py-0.5 bg-primary-500 text-white text-[8px] font-black rounded-full uppercase pulse-primary">New</span></template>
                            <span class="px-3 py-1 rounded-full border text-[10px] font-mono font-bold" :class="theme === 'light' ? 'bg-zinc-100 border-zinc-200 text-zinc-600' : 'bg-zinc-900 border-white/5 text-zinc-500'" x-text="item.version"></span>
                        </div>
                    </div>
                    <h3 class="text-xl font-black mb-2 tracking-tight uppercase italic text-left" :class="theme === 'light' ? 'text-zinc-900' : 'text-white'" x-text="item.name"></h3>
                    <p class="text-sm line-clamp-2 mb-10 font-medium leading-relaxed flex-1 text-left" :class="theme === 'light' ? 'text-zinc-600' : 'text-zinc-500'" x-text="item.description"></p>
                    <div class="mt-auto border-t pt-6 flex justify-between items-center text-left" :class="theme === 'light' ? 'border-zinc-100' : 'border-white/5'"><span class="verified-badge"><i data-lucide="shield-check" class="w-3 h-3"></i> Verified</span><i data-lucide="arrow-right" class="w-4 h-4 text-zinc-400 group-hover:text-primary-500 transition-all"></i></div>
                </div>
            </template>
        </div>

        <!-- List View -->
        <div x-show="view === 'list'" class="flex flex-col gap-3 text-left" x-cloak>
            <template x-for="item in filteredItems" :key="item.name">
                <div @click="openDrawer(item)" class="group flex items-center gap-6 px-6 py-4 rounded-2xl border transition-all cursor-pointer card-glow text-left"
                     :class="theme === 'light' ? 'bg-white border-zinc-200 shadow-sm' : 'bg-dark-700 border-white/5 shadow-lg'">
                    <div class="w-10 h-10 rounded-xl flex items-center justify-center text-primary-500 bg-primary-500/10"><i :data-lucide="getIcon(item.category)" class="w-5 h-5"></i></div>
                    <div class="flex-1 min-w-0 text-left"><div class="flex items-center gap-4"><h3 class="text-sm font-black uppercase group-hover:text-primary-500 transition-colors text-left" :class="theme === 'light' ? 'text-zinc-900' : 'text-white'" x-text="item.name"></h3><span class="text-[10px] font-mono font-bold text-zinc-500" x-text="item.version"></span></div></div>
                    <i data-lucide="chevron-right" class="w-5 h-5 text-zinc-400 group-hover:text-primary-500 group-hover:translate-x-1 transition-all"></i>
                </div>
            </template>
        </div>
    </main>

    <!-- Drawer -->
    <div x-show="drawerOpen" class="fixed inset-0 z-[100] flex justify-end text-left" x-cloak>
        <div x-show="drawerOpen" x-transition.opacity @click="drawerOpen = false" class="absolute inset-0 bg-black/60 backdrop-blur-sm"></div>
        <div x-show="drawerOpen" x-transition:enter="transform transition duration-300" x-transition:enter-start="translate-x-full" 
             class="relative w-full max-w-2xl h-full flex flex-col shadow-2xl overflow-hidden transition-colors text-left"
             :class="{ 'bg-white': theme === 'light', 'bg-dark-800': theme === 'deep', 'bg-dark-900': theme === 'oled' }">
            
            <div class="px-8 py-10 border-b flex items-center justify-between text-left" :class="theme === 'light' ? 'border-zinc-200' : 'border-white/5'">
                <div class="flex items-center gap-6 text-left">
                    <div class="w-16 h-16 rounded-3xl flex items-center justify-center bg-primary-500/10 text-primary-500 shadow-xl"><i :data-lucide="getIcon(selectedItem?.category)" class="w-8 h-8"></i></div>
                    <div class="text-left">
                        <h2 class="text-3xl font-black leading-none tracking-tighter uppercase italic text-white dark:text-white" :class="theme === 'light' ? 'text-zinc-900' : ''" x-text="selectedItem?.name"></h2>
                        <div class="flex items-center gap-2 mt-2 text-left"><span class="text-xs font-mono font-bold text-zinc-500" x-text="`v${selectedItem?.version}`"></span><span class="verified-badge"><i data-lucide="shield-check" class="w-3 h-3"></i> Verified</span></div>
                    </div>
                </div>
                <button @click="drawerOpen = false" class="p-2 rounded-xl text-zinc-500 hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-all"><i data-lucide="x" class="w-6 h-6"></i></button>
            </div>

            <div class="flex-1 overflow-y-auto p-8 space-y-12 scrollbar-hide text-left">
                <div x-data="{ tab: 'dnf', copied: false }" class="space-y-10 text-left">
                    <div class="flex flex-col gap-4 text-left">
                        <h3 class="text-[10px] font-black uppercase tracking-[0.3em] text-zinc-500 italic">Deployment</h3>
                        <div class="flex p-1.5 rounded-2xl w-fit" :class="theme === 'light' ? 'bg-zinc-200/50' : 'bg-black/50 border border-white/5'">
                            <button @click="tab = 'dnf'" :class="tab === 'dnf' ? 'bg-primary-600 text-white shadow-lg' : 'text-zinc-500 hover:text-zinc-300'" class="px-6 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all">DNF (RPM)</button>
                            <button @click="tab = 'docker'" :class="tab === 'docker' ? 'bg-primary-600 text-white shadow-lg' : 'text-zinc-500 hover:text-zinc-300'" class="px-6 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all">DOCKER</button>
                        </div>
                    </div>
                    <div x-show="tab === 'dnf'" class="space-y-6 text-left">
                        <div class="grid grid-cols-1 gap-2 text-left">
                            <template x-for="dist in (selectedItem?.artifacts?.rpm?.targets || ['el8', 'el9', 'el10'])"><div class="flex items-center justify-between p-4 rounded-2xl border text-left" :class="theme === 'light' ? 'bg-zinc-50 border-zinc-200' : 'bg-zinc-800/30 border-white/5'"><span class="text-[11px] font-black text-zinc-500 uppercase tracking-widest" x-text="dist"></span><div class="flex gap-2 text-left"><template x-for="arch in ['x86_64', 'aarch64']"><a :href="`${dist}/${arch}/${selectedItem.name}-${selectedItem.version}-1.${dist}.${arch}.rpm`" class="px-3 py-1.5 rounded-lg bg-primary-500/10 text-primary-500 hover:bg-primary-600 hover:text-white text-[9px] font-black uppercase transition-all" x-text="arch === 'x86_64' ? 'x86' : 'ARM'"></a></template></div></div></template>
                        </div>
                        <div class="rounded-2xl border p-6 font-mono text-xs relative text-left" :class="theme === 'light' ? 'bg-zinc-100 border-zinc-200' : 'bg-black border-white/10'"><p class="text-[9px] uppercase font-black text-zinc-600 mb-4 text-left">Quick Install</p><code class="text-emerald-500 font-bold" x-text="`sudo dnf install -y ${selectedItem?.name}`"></code></div>
                    </div>
                    <div x-show="tab === 'docker'" class="space-y-6 text-left">
                        <div class="rounded-2xl border p-6 font-mono text-xs space-y-6 text-left" :class="theme === 'light' ? 'bg-zinc-100 border-zinc-200' : 'bg-black border-white/10'"><div><p class="text-[9px] font-black text-zinc-600 mb-2 uppercase text-left">Registry Pull</p><code class="block break-all text-primary-500 text-left" x-text="`docker pull ghcr.io/sckyzo/monitoring-hub/${selectedItem?.name}:latest`"></code></div><div><p class="text-[9px] font-black text-zinc-600 mb-2 uppercase text-left">Run Container</p><code class="block break-all text-primary-500 text-left" x-text="`docker run -d -p 9100:9100 ghcr.io/sckyzo/monitoring-hub/${selectedItem?.name}:latest`"></code></div></div>
                    </div>
                </div>
                <div class="prose dark:prose-invert prose-sm max-w-none text-left"><h3 class="font-black text-xs uppercase tracking-[0.4em] text-zinc-500 mb-6 text-left">Documentation</h3><div x-html="renderMarkdown(selectedItem?.readme || selectedItem?.description)"></div></div>
            </div>
        </div>
    </div>

    <script id="exporters-data" type="application/json">{{ exporters_json | safe }}</script>
    <script id="categories-data" type="application/json">{{ categories_json | safe }}</script>

    <script>
        function registry() {
            return {
                exporters: [], categories: [], search: '', filterCategory: 'all', view: 'grid', drawerOpen: false, selectedItem: null, theme: 'oled', currentColor: 'Blue', currentColorRGB: '59, 130, 246', showCommandPalette: false,
                colors: [{ name: 'Blue', value: '59, 130, 246' }, { name: 'Emerald', value: '16, 185, 129' }, { name: 'Violet', value: '139, 92, 246' }, { name: 'Amber', value: '245, 158, 11' }, { name: 'Rose', value: '244, 63, 94' }],
                init() {
                    try { this.exporters = JSON.parse(document.getElementById('exporters-data').textContent); this.categories = JSON.parse(document.getElementById('categories-data').textContent); } catch(e) {}
                    this.theme = localStorage.getItem('appearance') || 'oled';
                    const savedColor = localStorage.getItem('color-theme');
                    if (savedColor) { const colorObj = this.colors.find(c => c.name === savedColor); if (colorObj) this.setThemeColor(colorObj); }
                    this.$nextTick(() => lucide.createIcons());
                    this.$watch('filteredItems', () => this.$nextTick(() => lucide.createIcons()));
                    this.$watch('showCommandPalette', (v) => { if(v) this.$nextTick(() => this.$refs.commandInput.focus()); });
                },
                setThemeColor(color) { this.currentColor = color.name; this.currentColorRGB = color.value; localStorage.setItem('color-theme', color.name); document.documentElement.style.setProperty('--primary-rgb', color.value); },
                changeCategory(cat) { this.filterCategory = 'none'; this.$nextTick(() => { this.filterCategory = cat; }); },
                get filteredItems() { return this.exporters.filter(item => item.name.toLowerCase().includes(this.search.toLowerCase()) && (this.filterCategory === 'all' || item.category === this.filterCategory)); },
                getIcon(cat) { return 'box'; },
                openDrawer(item) { this.selectedItem = item; this.drawerOpen = true; this.$nextTick(() => lucide.createIcons()); },
                renderMarkdown(text) { return marked.parse(text || ''); },
                copyToClipboard(text) { navigator.clipboard.writeText(text); }
            }
        }
    </script>
</body>
</html>
