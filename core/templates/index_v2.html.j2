<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monitoring Hub | The Exporter Factory</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        slate: {
                            950: '#020617',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        [x-cloak] { display: none !important; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #020617; }
        ::-webkit-scrollbar-thumb { background: #1e293b; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #334155; }
        .glass { background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.1); }
    </style>
</head>
<body class="bg-slate-950 text-slate-200 font-sans antialiased selection:bg-indigo-500/30" 
      x-data="{
        search: '', 
        selectedExporter: null, 
        tab: 'docker',
        exporters: [],
        loading: true,
        async init() {
            try {
                const resp = await fetch('catalog.json');
                const data = await resp.json();
                this.exporters = Object.keys(data).map(key => ({ name: key, ...data[key] }));
            } catch (e) {
                console.error('Failed to load catalog');
            } finally {
                this.loading = false;
                lucide.createIcons();
            }
        },
        get filteredExporters() {
            return this.exporters.filter(e => 
                e.name.toLowerCase().includes(this.search.toLowerCase()) || 
                e.description.toLowerCase().includes(this.search.toLowerCase())
            )
        },
        copyToClipboard(text) {
            navigator.clipboard.writeText(text);
            // On pourrait ajouter une petite notif toast ici
        }
      }">

    <!-- Navbar -->
    <nav class="sticky top-0 z-50 w-full border-b border-white/5 bg-slate-950/80 backdrop-blur-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center gap-3">
                    <div class="w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center shadow-lg shadow-indigo-500/20">
                        <i data-lucide="activity" class="w-5 h-5 text-white"></i>
                    </div>
                    <span class="text-lg font-bold tracking-tight text-white">Monitoring <span class="text-indigo-500">Hub</span></span>
                </div>
                
                <div class="hidden md:flex items-center gap-6 text-sm font-medium text-slate-400">
                    <a href="#" class="hover:text-white transition-colors">Documentation</a>
                    <a href="https://github.com/SckyzO/monitoring-hub" class="hover:text-white transition-colors flex items-center gap-2">
                        <i data-lucide="github" class="w-4 h-4"></i> GitHub
                    </a>
                    <div class="h-4 w-[1px] bg-white/10"></div>
                    <div class="flex items-center gap-2 text-emerald-500 bg-emerald-500/10 px-3 py-1 rounded-full text-xs">
                        <span class="relative flex h-2 w-2">
                            <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>
                            <span class="relative inline-flex rounded-full h-2 w-2 bg-emerald-500"></span>
                        </span>
                        Factory Online
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero -->
    <header class="relative overflow-hidden py-16 lg:py-24">
        <div class="absolute top-0 left-1/2 -translate-x-1/2 w-full h-full bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-indigo-500/10 via-transparent to-transparent opacity-50 pointer-events-none"></div>
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center relative z-10">
            <h1 class="text-4xl lg:text-6xl font-extrabold text-white tracking-tight mb-6">
                The Definitive <span class="text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-cyan-400">Exporter Factory</span>
            </h1>
            <p class="max-w-2xl mx-auto text-lg text-slate-400 mb-10 leading-relaxed">
                Automated multi-arch builds for Prometheus exporters. <br class="hidden sm:inline"> Standardized, secured, and always up-to-date.
            </p>
            
            <!-- Search Bar -->
            <div class="max-w-xl mx-auto relative group">
                <div class="absolute inset-y-0 left-4 flex items-center pointer-events-none text-slate-500 group-focus-within:text-indigo-400 transition-colors">
                    <i data-lucide="search" class="w-5 h-5"></i>
                </div>
                <input type="text" 
                       x-model="search"
                       placeholder="Search among 20+ exporters (e.g. mysql, redis, ipmi...)"
                       class="w-full bg-slate-900 border border-white/10 rounded-2xl py-4 pl-12 pr-4 text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500/50 transition-all shadow-2xl">
                <div class="absolute right-4 top-1/2 -translate-y-1/2 hidden sm:flex items-center gap-1 text-[10px] font-bold text-slate-500 bg-slate-800 px-2 py-1 rounded border border-white/5">
                    <span>CTRL</span><span>K</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-24">
        
        <!-- Loading State -->
        <div x-show="loading" class="flex flex-col items-center justify-center py-20">
            <div class="w-12 h-12 border-4 border-indigo-500/20 border-t-indigo-500 rounded-full animate-spin mb-4"></div>
            <p class="text-slate-500 font-medium">Synchronizing with factory...</p>
        </div>

        <!-- Empty State -->
        <div x-show="!loading && filteredExporters.length === 0" class="text-center py-20 border-2 border-dashed border-white/5 rounded-3xl">
            <i data-lucide="package-search" class="w-12 h-12 text-slate-600 mx-auto mb-4"></i>
            <h3 class="text-xl font-semibold text-white">No exporter found</h3>
            <p class="text-slate-500">Try searching for something else, like 'node' or 'nginx'.</p>
        </div>

        <!-- Grid -->
        <div x-show="!loading && filteredExporters.length > 0" 
             class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"
             x-transition:enter="transition ease-out duration-300"
             x-transition:enter-start="opacity-0 translate-y-4"
             x-transition:enter-end="opacity-100 translate-y-0">
            
            <template x-for="exporter in filteredExporters" :key="exporter.name">
                <div class="group bg-slate-900/50 border border-white/5 rounded-2xl p-6 hover:border-indigo-500/50 hover:bg-slate-900 transition-all cursor-pointer relative overflow-hidden"
                     @click="selectedExporter = exporter">
                    
                    <!-- Glow effect on hover -->
                    <div class="absolute -top-24 -right-24 w-48 h-48 bg-indigo-500/5 blur-[80px] group-hover:bg-indigo-500/10 transition-all"></div>

                    <div class="flex justify-between items-start mb-4 relative z-10">
                        <div class="p-2 bg-indigo-500/10 rounded-lg text-indigo-400 group-hover:bg-indigo-500 group-hover:text-white transition-all">
                            <i data-lucide="package" class="w-6 h-6"></i>
                        </div>
                        <div class="flex flex-col items-end">
                            <span class="text-[10px] uppercase font-bold tracking-widest text-slate-500 mb-1">Version</span>
                            <span class="text-sm font-mono font-medium text-indigo-400 bg-indigo-400/5 px-2 py-0.5 rounded border border-indigo-400/10" x-text="exporter.version"></span>
                        </div>
                    </div>

                    <h2 class="text-xl font-bold text-white mb-2 group-hover:text-indigo-400 transition-colors" x-text="exporter.name.replace('_', ' ')"></h2>
                    <p class="text-sm text-slate-400 leading-relaxed mb-6 line-clamp-2" x-text="exporter.description"></p>

                    <div class="flex items-center gap-3 relative z-10">
                        <div class="flex -space-x-2">
                            <template x-for="arch in exporter.architectures">
                                <div class="w-7 h-7 rounded-full bg-slate-800 border-2 border-slate-950 flex items-center justify-center text-[8px] font-bold text-slate-300" 
                                     :title="arch" x-text="arch === 'amd64' ? 'x64' : 'ARM'"></div>
                            </template>
                        </div>
                        <div class="h-4 w-[1px] bg-white/10 mx-1"></div>
                        <div class="flex items-center gap-1.5">
                            <template x-for="dist in exporter.distributions">
                                <span class="text-[9px] font-bold text-slate-500 bg-slate-800/50 px-1.5 py-0.5 rounded" x-text="dist.toUpperCase()"></span>
                            </template>
                        </div>
                    </div>
                </div>
            </template>
        </div>
    </main>

    <!-- Detail Drawer Overlay -->
    <div x-show="selectedExporter" 
         class="fixed inset-0 z-[100] flex justify-end"
         x-cloak>
        <!-- Backdrop -->
        <div x-show="selectedExporter"
             @click="selectedExporter = null"
             x-transition:enter="transition ease-out duration-300"
             x-transition:enter-start="opacity-0"
             x-transition:enter-end="opacity-100"
             class="absolute inset-0 bg-slate-950/60 backdrop-blur-sm"></div>
        
        <!-- Panel -->
        <div x-show="selectedExporter"
             x-transition:enter="transition ease-out duration-300 transform"
             x-transition:enter-start="translate-x-full"
             x-transition:enter-end="translate-x-0"
             class="relative w-full max-w-2xl bg-slate-900 shadow-2xl border-l border-white/10 flex flex-col h-full">
            
            <!-- Drawer Header -->
            <div class="p-6 border-b border-white/5 flex items-center justify-between">
                <div class="flex items-center gap-4">
                    <button @click="selectedExporter = null" class="p-2 hover:bg-slate-800 rounded-full text-slate-400 hover:text-white transition-all">
                        <i data-lucide="x" class="w-6 h-6"></i>
                    </button>
                    <h2 class="text-2xl font-bold text-white" x-text="selectedExporter?.name"></h2>
                </div>
                <div class="flex items-center gap-2">
                    <span class="text-xs font-mono text-indigo-400" x-text="selectedExporter?.version"></span>
                </div>
            </div>

            <!-- Drawer Content -->
            <div class="flex-1 overflow-y-auto p-8">
                <!-- Info Section -->
                <section class="mb-10">
                    <h3 class="text-sm font-bold uppercase tracking-widest text-slate-500 mb-4">Description</h3>
                    <p class="text-slate-300 leading-relaxed text-lg" x-text="selectedExporter?.description"></p>
                </section>

                <!-- Installation Tabs -->
                <section class="mb-10" x-data="{ tab: 'docker' }">
                    <h3 class="text-sm font-bold uppercase tracking-widest text-slate-500 mb-4">Installation Guide</h3>
                    
                    <div class="flex p-1 bg-slate-950 rounded-xl mb-4 w-fit">
                        <button @click="tab = 'docker'" 
                                :class="tab === 'docker' ? 'bg-indigo-600 text-white shadow-lg' : 'text-slate-400 hover:text-white'"
                                class="px-4 py-2 rounded-lg text-sm font-medium transition-all flex items-center gap-2">
                            <i data-lucide="container" class="w-4 h-4"></i> Docker
                        </button>
                        <button @click="tab = 'rpm'" 
                                :class="tab === 'rpm' ? 'bg-indigo-600 text-white shadow-lg' : 'text-slate-400 hover:text-white'"
                                class="px-4 py-2 rounded-lg text-sm font-medium transition-all flex items-center gap-2">
                            <i data-lucide="box" class="w-4 h-4"></i> RPM (DNF)
                        </button>
                    </div>

                    <!-- Docker Tab -->
                    <div x-show="tab === 'docker'" class="space-y-4" x-transition:enter="transition duration-200">
                        <div class="bg-slate-950 rounded-2xl overflow-hidden border border-white/5 shadow-inner">
                            <div class="flex items-center justify-between px-4 py-2 bg-white/5 border-b border-white/5 text-[10px] font-bold text-slate-500">
                                <span>DOCKER RUN</span>
                                <button @click="copyToClipboard(`docker pull ghcr.io/sckyzo/monitoring-hub/${selectedExporter.name}:latest`)" 
                                        class="hover:text-white flex items-center gap-1 uppercase">
                                    <i data-lucide="copy" class="w-3 h-3"></i> Copy
                                </button>
                            </div>
                            <pre class="p-4 overflow-x-auto"><code class="text-sm font-mono text-indigo-300" x-text="`docker run -d -p ${selectedExporter?.port}:${selectedExporter?.port} ghcr.io/sckyzo/monitoring-hub/${selectedExporter?.name}:latest`"></code></pre>
                        </div>
                    </div>

                    <!-- RPM Tab -->
                    <div x-show="tab === 'rpm'" class="space-y-4" x-transition:enter="transition duration-200">
                        <div class="bg-slate-950 rounded-2xl overflow-hidden border border-white/5">
                            <div class="flex items-center justify-between px-4 py-2 bg-white/5 border-b border-white/5 text-[10px] font-bold text-slate-500">
                                <span>SHELL</span>
                                <button @click="copyToClipboard(`sudo dnf config-manager --add-repo https://sckyzo.github.io/monitoring-hub/el9/$(arch)/ && sudo dnf install -y ${selectedExporter.name}`)"
                                        class="hover:text-white flex items-center gap-1 uppercase">
                                    <i data-lucide="copy" class="w-3 h-3"></i> Copy
                                </button>
                            </div>
                            <pre class="p-4 overflow-x-auto"><code class="text-sm font-mono text-emerald-300" x-text="`# Add repo and install
sudo dnf install -y ${selectedExporter?.name}`"></code></pre>
                        </div>
                    </div>
                </section>

                <!-- Stats/Badges -->
                <section class="grid grid-cols-2 gap-4">
                    <div class="bg-white/5 rounded-2xl p-4 border border-white/5">
                        <span class="text-[10px] font-bold text-slate-500 uppercase block mb-1">Architecture</span>
                        <div class="flex gap-2">
                            <template x-for="arch in selectedExporter?.architectures">
                                <span class="text-xs font-semibold text-white px-2 py-1 bg-slate-800 rounded" x-text="arch"></span>
                            </template>
                        </div>
                    </div>
                    <div class="bg-white/5 rounded-2xl p-4 border border-white/5">
                        <span class="text-[10px] font-bold text-slate-500 uppercase block mb-1">Targets</span>
                        <div class="flex gap-2 flex-wrap">
                            <template x-for="dist in selectedExporter?.distributions">
                                <span class="text-xs font-semibold text-white px-2 py-1 bg-slate-800 rounded" x-text="dist"></span>
                            </template>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Drawer Footer -->
            <div class="p-6 border-t border-white/5 bg-white/5 flex gap-4">
                <a :href="`https://github.com/${selectedExporter?.upstream_repo}`" target="_blank"
                   class="flex-1 flex items-center justify-center gap-2 py-3 bg-white/10 hover:bg-white/20 text-white rounded-xl font-semibold transition-all">
                    <i data-lucide="external-link" class="w-4 h-4"></i> Upstream Repository
                </a>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="border-t border-white/5 py-12 bg-slate-950">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col md:flex-row justify-between items-center gap-6">
            <p class="text-slate-500 text-sm">
                &copy; 2026 Monitoring Hub Factory. Distributed under MIT License.
            </p>
            <div class="flex items-center gap-6">
                <a href="#" class="text-slate-500 hover:text-white transition-colors"><i data-lucide="twitter" class="w-5 h-5"></i></a>
                <a href="#" class="text-slate-500 hover:text-white transition-colors"><i data-lucide="github" class="w-5 h-5"></i></a>
            </div>
        </div>
    </footer>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();
    </script>
</body>
</html>